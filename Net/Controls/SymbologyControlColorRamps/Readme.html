<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <title>Retrieve a color ramp from the SymbologyControl</title>
  <style>
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    th, td {
      padding: 5px;
    }
    th {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Retrieve a color ramp from the SymbologyControl</h2>

<h3>Purpose</h3>

<p>This sample demonstrates how to retrieve a color ramp from the SymbologyControl and use it within a ClassBreaksRenderer. The sample uses the SymbologyControl in conjunction with the PageLayoutControl, ToolbarControl, and the controls commands.  </p>

<h3>Usage</h3>

<ol>
<li>Open a map document and select a polygon feature layer.    </li>
<li>Select a color ramp and field, then set the number of classes.   </li>
</ol>

<h4>Additional information</h4>

<div xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2006-02-10T23:25:53">When a document is loaded into the PageLayoutControl, the OnPageLayoutReplaced event is fired and used to populate a combo box with a list of polygon feature classes implementing IGeoFeatureLayer. The layer selected in the combo box is rendered with a ClassBreaksRenderer using the IGeoFeatureLayer.Renderer property.</div>  

<div xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2006-02-10T23:25:53"> </div>  

<div xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2006-02-10T23:25:53">Within the Form_Load event of the SymbolForm, the LoadStyleFile method is used to add the contents of the ESRI.ServerStyle into the SymbologyControl, and the StyleClass property is used to show color ramps. A combo box is populated with the names of the numeric fields within the FeatureClass. The minimum and maximum values within selected fields are shown using the IStatisticsResults.Maximum and IStatisticsResults.Minimum properties.</div>  

<div xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2006-02-10T23:25:53"> </div>  

<div xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2006-02-10T23:25:53">Clicking an item in the SymbologyControl passes the selected IStyleGalleryItem object to the OnItemSelected event. A ColorRamp is returned from the IStyleGalleryItem.Item property. The IColorRamp.Size and IClassBreaksRenderer.BreakCount properties are set to the number of classes specified by the end user. For each break in the ClassBreaksRenderer, the IClassBreaksRenderer.Symbol is set with a SimpleFillSymbol.Color specified by the next color in the ColorRamp.</div>  

<h4>See Also</h4>

<p><a href="http://desktopdev.arcgis.com/search/?q=SymbologyControl%20Class&amp;p=0&amp;language=en&amp;product=arcobjects-sdk-dotnet&amp;version=&amp;n=15&amp;collection=help">SymbologyControl Class</a><br />
<a href="http://desktopdev.arcgis.com/search/?q=ISymbologyControl%20Interface&amp;p=0&amp;language=en&amp;product=arcobjects-sdk-dotnet&amp;version=&amp;n=15&amp;collection=help">ISymbologyControl Interface</a><br />
<a href="http://desktopdev.arcgis.com/search/?q=ISymbologyStyleClass%20Interface&amp;p=0&amp;language=en&amp;product=arcobjects-sdk-dotnet&amp;version=&amp;n=15&amp;collection=help">ISymbologyStyleClass Interface</a>  </p>

<hr />

<h4>Licensing</h4>

<table><tr><th> Development licensing </th><th> Deployment licensing </th></tr>
<tr><td> Engine Developer Kit </td><td> Engine </td></tr>  
<tr><td>  </td><td> ArcGIS for Desktop Basic </td></tr>  
<tr><td>  </td><td> ArcGIS for Desktop Standard </td></tr>  
<tr><td>  </td><td> ArcGIS for Desktop Advanced </td></tr>  
</table>

</body>
</html>